<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
	<title>Cells And Values In AFC - Abacus Formula Compiler for Java</title>
    <style media="screen" type="text/css">
		
    </style>
	<link href="../../style_screen.css" rel="stylesheet" type="text/css" media="screen" /><link href="../../style_print.css" rel="stylesheet" type="text/css" media="print" /><link href="refstyle.css" rel="stylesheet" type="text/css" />

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1112076-2");
pageTracker._initData();
pageTracker._trackPageview();
</script>
</head>

<body>
	<div id="outer">
		<div id="left_background">
		</div>
		<div id="top_background">
		</div>
		
		<div class="chrome" id="top_chrome">
			<div id="logo_band">
				<img src="../../site_img/header_bar.gif" alt="AFC - Abacus Formula Compiler for Java" />
			</div>
			<div id="area_band">
				<div id="download_band">
					<a href="../../download/index.htm">
						<img src="../../site_img/download_button.png" />
					</a>
				</div>
				<table height="100%"><tr height="100%"><td style="vertical-align:middle">
						
					<a href="../../index.htm">Home</a> | 
						
					<a href="../../quick.htm">Quick Start</a> | <span class="selected"><a href="../../doc/index.htm">Documentation</a></span> | <a href="../../download/index.htm">Download</a> | <a href="../../support/index.htm">Support</a> | <a href="../../contribute/index.htm">Contribute</a>
				</td></tr></table>
			</div>
		</div>

		<div id="inner">
			<div class="chrome" id="inner_top_chrome">
				<div id="crumbs_band">
					<a href="../../index.htm">Home</a> &gt; <a href="../index.htm">Documentation</a> &gt; <a href="index.htm">Reference</a> &gt; 
				</div>
			</div>

			<div class="content" id="content">

<h1>Cells And Values In <span class="caps">AFC</span></h1>

	<p><span class="caps">AFC</span> supports the following types of values in cells:</p>

<ul>
	<li>strings</li>
	<li>numbers (including monetary and percentage values)</li>
	<li>dates and times</li>
	<li>booleans</li>
</ul>

	<p>Internally, <span class="caps">AFC</span> really only supports two basic data types: numbers and strings. This suffices because Excel internally treats dates, times, and booleans as numbers, too.</p>


	<p>For a particular engine compiled by <span class="caps">AFC</span>, the numbers are all of the same type. The default is the <code>double</code> type, which is what Excel uses as well. See the tutorial for details on the <a href="../tutorial/numeric_type.htm">available numeric types</a> and how to choose one.</p>



	<h2><a name="pagetoc__1">Cell References</a></h2>

	<p><span class="caps">AFC</span> supports the following styles of cell and range references:</p>



<h5 class="ref"><a name="pagetoc__1_1">Relative reference</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td></td></tr></thead><tbody>
<tr><td class="xl-row">2</td><td class="xl-num">1.0</td><td class="xl-exp"><a href="CellNames_2.htm">=[.C2]</a></td><td class="xl-num">1.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_2">Absolute references</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td></td></tr></thead><tbody>
<tr><td class="xl-row">3</td><td class="xl-num">6.0</td><td class="xl-exp"><a href="CellNames_3.htm">=[.<em>$</em>C<em>$</em>3]+[.<em>$</em>C3]+[.C<em>$</em>3]</a></td><td class="xl-num">2.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_3">Simple name</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td></td></tr></thead><tbody>
<tr><td class="xl-row">4</td><td class="xl-num">3.0</td><td class="xl-exp"><a href="CellNames_4.htm">=MYCELL</a></td><td class="xl-num">3.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_4">Two names for same cell</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td></td></tr></thead><tbody>
<tr><td class="xl-row">5</td><td class="xl-num">8.0</td><td class="xl-exp"><a href="CellNames_5.htm">=_MY_CELL_+_MY_CELL</a></td><td class="xl-num">4.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_5">Unconventional names</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td></td></tr></thead><tbody>
<tr><td class="xl-row">6</td><td class="xl-num">5.0</td><td class="xl-exp"><a href="CellNames_6.htm">=_MY.CELL.1X</a></td><td class="xl-num">5.0</td><td></td></tr>
<tr><td class="xl-row">7</td><td class="xl-num">6.0</td><td class="xl-exp"><a href="CellNames_7.htm">=MY23.43CELL</a></td><td class="xl-num">6.0</td><td></td></tr>
<tr><td class="xl-row">8</td><td class="xl-num">7.0</td><td class="xl-exp"><a href="CellNames_8.htm">=_12345</a></td><td class="xl-num">7.0</td><td></td></tr>
<tr><td class="xl-row">9</td><td class="xl-num">400.0</td><td class="xl-exp"><a href="CellNames_9.htm">=A1B+A1_+A1_1+A_1+A__1</a></td><td class="xl-num">100.0</td><td class="xl-num">90.0</td><td class="xl-num">80.0</td><td class="xl-num">70.0</td><td class="xl-num">60.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_6">Range with cell references</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td></td></tr></thead><tbody>
<tr><td class="xl-row">11</td><td class="xl-num">6.0</td><td class="xl-exp"><a href="CellNames_11.htm">=SUM([.C11:.E11])</a></td><td class="xl-num">1.0</td><td class="xl-num">2.0</td><td class="xl-num">3.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_7">Range name</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td></td></tr></thead><tbody>
<tr><td class="xl-row">12</td><td class="xl-num">15.0</td><td class="xl-exp"><a href="CellNames_12.htm">=SUM(Range)</a></td><td class="xl-num">4.0</td><td class="xl-num">5.0</td><td class="xl-num">6.0</td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__1_8">References to other sheets</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td></td></tr></thead><tbody>
<tr><td class="xl-row">14</td><td class="xl-num">30.0</td><td class="xl-exp"><a href="CellNames_14.htm">=[$SecondSheet.B1]+CellOnThirdSheet</a></td><td class="xl-num">10.0</td><td class="xl-num">20.0</td><td></td></tr>
</tbody></table><p></p>

	<h2><a name="pagetoc__2">Empty Cells</a></h2>

	<p><span class="caps">AFC</span> currently has no proper support for empty cells. It simply treats them like the number zero (<code>0.0</code>). This is usually correct (even for multiplication with <code>*</code>, where Excel treats empty cells as zero too), but fails most noticeably in <a href="aggregators.htm">aggregators</a> like <code>COUNT</code>, <code>AVERAGE</code>, or <code>PRODUCT</code> (where Excel skips empty cells):</p>



<h5 class="ref"><a name="pagetoc__2_1">Empty cells with +</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td></td></tr></thead><tbody>
<tr><td class="xl-row">2</td><td class="xl-num">5.0</td><td class="xl-exp"><a href="EmptyCells_2.htm">=[.C2]<em>+</em>[.D2]</a></td><td class="xl-num">2.0</td><td class="xl-num">3.0</td><td></td></tr>
<tr><td class="xl-row">3</td><td class="xl-num">5.0</td><td class="xl-exp">...</td><td><td class="xl-num">5.0</td></td><td></td></tr>
<tr><td class="xl-row">4</td><td class="xl-num">6.0</td><td class="xl-exp">...</td><td class="xl-num">6.0</td><td></td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__2_2">Empty cells with *</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td></td></tr></thead><tbody>
<tr><td class="xl-row">6</td><td class="xl-num">6.0</td><td class="xl-exp"><a href="EmptyCells_6.htm">=[.C6]<em>*</em>[.D6]</a></td><td class="xl-num">2.0</td><td class="xl-num">3.0</td><td></td></tr>
<tr><td class="xl-row">7</td><td class="xl-num">0.0</td><td class="xl-exp">...</td><td><td class="xl-num">5.0</td></td><td></td></tr>
<tr><td class="xl-row">8</td><td class="xl-num">0.0</td><td class="xl-exp">...</td><td class="xl-num">6.0</td><td></td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__2_3">Empty cells with PRODUCT return 0!</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td></td></tr></thead><tbody>
<tr><td class="xl-row">10</td><td class="xl-num">6.0</td><td class="xl-exp"><a href="EmptyCells_10.htm">=<em>PRODUCT</em>([.C10];[.D10])</a></td><td class="xl-num">2.0</td><td class="xl-num">3.0</td><td></td></tr>
<tr><td class="xl-row">11</td><td class="xl-num">0.0</td><td class="xl-exp">...</td><td><td class="xl-num">5.0</td></td><td><td class="ref-bad">Excel says: 5.0</td></td></tr>
<tr><td class="xl-row">12</td><td class="xl-num">0.0</td><td class="xl-exp">...</td><td class="xl-num">6.0</td><td></td><td><td class="ref-bad">Excel says: 6.0</td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__2_4">Empty cells with SUMIF</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td></td></tr></thead><tbody>
<tr><td class="xl-row">14</td><td class="xl-num">10.0</td><td class="xl-exp"><a href="EmptyCells_14.htm">=<em>SUMIF</em>([.C14:.E14];"=10")</a></td><td><td class="xl-num">10.0</td></td><td></td><td></td></tr>
</tbody></table><p></p>

	<h2><a name="pagetoc__3">Formula Errors</a></h2>

	<p><span class="caps">AFC</span> <a href="../tutorial/exceptions.htm">throws exceptions or returns error values</a> for Excel error values:</p>



<h5 class="ref"><a name="pagetoc__3_1">Errors</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td><td>C</td><td>D</td></td></tr></thead><tbody>
<tr><td class="xl-row">2</td><td>!<acronym title="NotAvailableException">NA</acronym></td><td class="xl-exp"><a href="ErrorCells_2.htm">=NA()</a></td><td><td class="ref-bad">Excel says: Err:32767</td></td></tr>
<tr><td class="xl-row">3</td><td>!<acronym title="Not A Number (double)">NaN</acronym>/<acronym title="FormulaException">FE</acronym></td><td class="xl-exp"><a href="ErrorCells_3.htm">=SQRT([.C3])</a></td><td class="xl-num">-1.0</td><td><td class="ref-bad">Excel says: Err:502</td></td></tr>
<tr><td class="xl-row">4</td><td>!<acronym title="Positive Infinity (double)">+Inf</acronym>/<acronym title="FormulaException">FE</acronym></td><td class="xl-exp"><a href="ErrorCells_4.htm">=POWER([.C4];[.D4])</a></td><td class="xl-num">0.0</td><td class="xl-num">-2.0</td><td><td class="ref-bad">Excel says: Err:503</td></td></tr>
<tr><td class="xl-row">5</td><td>!<acronym title="Not A Number (double)">NaN</acronym>/<acronym title="FormulaException">FE</acronym></td><td class="xl-exp"><a href="ErrorCells_5.htm">=ACOS([.C5])</a></td><td class="xl-num">1.1</td><td><td class="ref-bad">Excel says: Err:519</td></td></tr>
<tr><td class="xl-row">6</td><td>!<acronym title="Positive Infinity (double)">+Inf</acronym>/<acronym title="ArithmeticException">AE</acronym></td><td class="xl-exp"><a href="ErrorCells_6.htm">=[.C6]/[.D6]</a></td><td class="xl-num">1.0</td><td class="xl-num">0.0</td><td><td class="ref-bad">Excel says: Err:532</td></td></tr>
<tr><td class="xl-row">7</td><td>!<acronym title="Not A Number (double)">NaN</acronym>/<acronym title="FormulaException">FE</acronym></td><td class="xl-exp"><a href="ErrorCells_7.htm">=SQRT(-1)</a></td><td><td class="ref-bad">Excel says: Err:502</td></td></tr>
<tr><td class="xl-row">8</td><td>!<acronym title="Positive Infinity (double)">+Inf</acronym>/<acronym title="FormulaException">FE</acronym></td><td class="xl-exp"><a href="ErrorCells_8.htm">=POWER(0;-2)</a></td><td><td class="ref-bad">Excel says: Err:503</td></td></tr>
<tr><td class="xl-row">9</td><td>!<acronym title="Not A Number (double)">NaN</acronym>/<acronym title="FormulaException">FE</acronym></td><td class="xl-exp"><a href="ErrorCells_9.htm">=ACOS(1.1)</a></td><td><td class="ref-bad">Excel says: Err:519</td></td></tr>
<tr><td class="xl-row">10</td><td>!<acronym title="Positive Infinity (double)">+Inf</acronym>/<acronym title="ArithmeticException">AE</acronym></td><td class="xl-exp"><a href="ErrorCells_10.htm">=1/0</a></td><td><td class="ref-bad">Excel says: Err:532</td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__3_2">ISNA()</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td></td></tr></thead><tbody>
<tr><td class="xl-row">12</td><td>true</td><td class="xl-exp"><a href="ErrorCells_12.htm">=<em>ISNA</em>(NA())</a></td><td></td></tr>
<tr><td class="xl-row">13</td><td>false</td><td class="xl-exp"><a href="ErrorCells_13.htm">=<em>ISNA</em>(1)</a></td><td></td></tr>
<tr><td class="xl-row">14</td><td>false</td><td class="xl-exp"><a href="ErrorCells_14.htm">=<em>ISNA</em>(1/0)</a></td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__3_3">ISERR()</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td></td></tr></thead><tbody>
<tr><td class="xl-row">16</td><td>false</td><td class="xl-exp"><a href="ErrorCells_16.htm">=<em>ISERR</em>(NA())</a></td><td></td></tr>
<tr><td class="xl-row">17</td><td>false</td><td class="xl-exp"><a href="ErrorCells_17.htm">=<em>ISERR</em>(1)</a></td><td></td></tr>
<tr><td class="xl-row">18</td><td>true</td><td class="xl-exp"><a href="ErrorCells_18.htm">=<em>ISERR</em>(1/0)</a></td><td></td></tr>
</tbody></table><p></p>
<h5 class="ref"><a name="pagetoc__3_4">ISERROR()</a></h5>
<table class="xl ref"><thead><tr><td><td>A</td><td>B</td></td></tr></thead><tbody>
<tr><td class="xl-row">20</td><td>true</td><td class="xl-exp"><a href="ErrorCells_20.htm">=<em>ISERROR</em>(NA())</a></td><td></td></tr>
<tr><td class="xl-row">21</td><td>false</td><td class="xl-exp"><a href="ErrorCells_21.htm">=<em>ISERROR</em>(1)</a></td><td></td></tr>
<tr><td class="xl-row">22</td><td>true</td><td class="xl-exp"><a href="ErrorCells_22.htm">=<em>ISERROR</em>(1/0)</a></td><td></td></tr>
</tbody></table><p></p>

	<h2><a name="pagetoc__4">Numeric Precision</a></h2>

	<p><span class="caps">AFC</span> ignores the number of decimal places specified for displaying cell results in Excel. If you want rounded results, you have to use the <code>ROUND()</code> function explicitly. This is consistent with Excel also not limiting the precision on intermediate results.</p>

			</div>
			<div class="chrome" id="inner_bottom_chrome">
			</div>
		</div>
		
		
		
		<div class="chrome" id="left_top_chrome">
			<div id="area_toc"><div class="area"><a href="../../doc/design.htm">Design Overview</a></div>
<div class="area"><a href="../../doc/tutorial/index.htm">Tutorial</a></div>
<div class="area"><span class="selected"><a href="../../doc/reference/index.htm">Function Reference</a></span></div>
<div class="nested">
<div class="area"><span class="selected">Cells And Values In AFC</span></div>
<div id="page_toc"><div class="toc"><ul class="toc toc1"><li class="withitems"><a href="#pagetoc__1">Cell References</a><ul class="toc toc4"><li><a href="#pagetoc__1_1">Relative reference</a></li><li><a href="#pagetoc__1_2">Absolute references</a></li><li><a href="#pagetoc__1_3">Simple name</a></li><li><a href="#pagetoc__1_4">Two names for same cell</a></li><li><a href="#pagetoc__1_5">Unconventional names</a></li><li><a href="#pagetoc__1_6">Range with cell references</a></li><li><a href="#pagetoc__1_7">Range name</a></li><li><a href="#pagetoc__1_8">References to other sheets</a></li></ul></li><li class="withitems"><a href="#pagetoc__2">Empty Cells</a><ul class="toc toc4"><li><a href="#pagetoc__2_1">Empty cells with +</a></li><li><a href="#pagetoc__2_2">Empty cells with *</a></li><li><a href="#pagetoc__2_3">Empty cells with PRODUCT return 0!</a></li><li><a href="#pagetoc__2_4">Empty cells with SUMIF</a></li></ul></li><li class="withitems"><a href="#pagetoc__3">Formula Errors</a><ul class="toc toc4"><li><a href="#pagetoc__3_1">Errors</a></li><li><a href="#pagetoc__3_2">ISNA()</a></li><li><a href="#pagetoc__3_3">ISERR()</a></li><li><a href="#pagetoc__3_4">ISERROR()</a></li></ul></li><li><a href="#pagetoc__4">Numeric Precision</a></li></ul></div></div>
</div>
<div class="area"><a href="../../doc/javadoc/index.html">API Reference</a></div>
<div class="area"><a href="../../doc/examples/index.htm">Sample Applications</a></div>
<div class="area"><a href="../../doc/impl/index.htm">Implementation Details</a></div>
<div class="area"><a href="../../doc/limitations.htm">Limitations</a></div></div>
		</div>
		</div>
		<div class="chrome" id="left_bottom_chrome">
			<div id="copyright">
				Copyright &copy; 2005-2008 by <a href="http://www.abacus.ch/">Abacus Research AG</a>.  All rights reserved.
			</div>
		</div>
	
</body>
</html>
