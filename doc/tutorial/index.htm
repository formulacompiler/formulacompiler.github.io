<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
	<title>Tutorial - Abacus Formula Compiler for Java</title>
    <style media="screen" type="text/css">
		
    </style>
	<link href="../../style_screen.css" rel="stylesheet" type="text/css" media="screen" /><link href="../../style_print.css" rel="stylesheet" type="text/css" media="print" />

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1112076-2");
pageTracker._initData();
pageTracker._trackPageview();
</script>
</head>

<body>
	<div id="outer">
		<div id="left_background">
		</div>
		<div id="top_background">
		</div>
		
		<div class="chrome" id="top_chrome">
			<div id="logo_band">
				<img src="../../site_img/header_bar.gif" alt="AFC - Abacus Formula Compiler for Java" />
			</div>
			<div id="area_band">
				<div id="download_band">
					<a href="../../download/index.htm">
						<img src="../../site_img/download_button.png" />
					</a>
				</div>
				<table height="100%"><tr height="100%"><td style="vertical-align:middle">
						
					<a href="../../index.htm">Home</a> | 
						
					<a href="../../quick.htm">Quick Start</a> | <span class="selected"><a href="../../doc/index.htm">Documentation</a></span> | <a href="../../download/index.htm">Download</a> | <a href="../../support/index.htm">Support</a> | <a href="../../contribute/index.htm">Contribute</a>
				</td></tr></table>
			</div>
		</div>

		<div id="inner">
			<div class="chrome" id="inner_top_chrome">
				<div id="crumbs_band">
					<a href="../../index.htm">Home</a> &gt; <a href="../index.htm">Documentation</a> &gt; 
				</div>
			</div>

			<div class="content" id="content">

<h1>Tutorial</h1>

	<p>This is the tutorial for the Abacus Formula Compiler (AFC). It is organized as a collection of examples and reference topics, which are best read in the order presented here. You might also want to have a look at the <a href="../reference/index.htm">Function Reference</a> and the <a href="../javadoc/index.html">API Reference</a>.</p>


	<h2>Fundamentals</h2>

<dl>
<dt><a href="reason.htm">The Reason</a></dt><dd>To demonstrate why <span class="caps">AFC</span> was built, I introduce a simple example: an order entry application where the line item rebate is made customizable. The shortcomings of this solution are overcome in the topic below, which introduces <span class="caps">AFC</span>.</dd>

<dt><a href="basics.htm">The Basics</a></dt><dd>Line item pricing revisited: a simple case study that introduces the main concepts of <span class="caps">AFC</span>.</dd>

<dt><a href="numeric_type.htm">Numeric Type</a></dt><dd><span class="caps">AFC</span> normally does all numeric calculations using the <code>double</code> type. This is often not acceptable for financial applications. This topic shows how to make an engine use one of the precise types <code>BigDecimal</code> and scaled <code>long</code> for all numeric computations.</dd>

<dt><a href="computation_mode.htm">Computation Mode</a></dt><dd>Different spreadsheet applications calculate some expressions slightly differently. The computation mode tells <span class="caps">AFC</span> which particular spreadsheet application to emulate.</dd>

<dt><a href="type_conversion.htm">Type Conversions</a></dt><dd>Your input and output interfaces should ideally not be tailored to <span class="caps">AFC</span>. AFC therefore can convert a variety of numeric input and output data types from/to its internal numeric type.</dd>

<dt><a href="locale.htm">Locale and Time Zone</a></dt><dd>There are a few spreadsheet functions that need to take a user&#8217;s locale and time zone into account. While the default is to use the current settings, server-side applications might want to override them.</dd>

<dt><a href="datetime.htm">Dates, Times, Durations and Time Zones</a></dt><dd>The proper handling of time zones can be more complex than just setting the user&#8217;s time zone correctly.</dd>

<dt><a href="caching.htm">Caching Of Values and Reusing Computations</a></dt><dd>Many computations can be sped up by turning on internal caching of cell values. And some functions (<code>NOW</code> and <code>MATCH</code>, for example), or repeating sections, <em>always</em> use internal caches. Caches, however, introduce state. You need to reset this state when reusing computations on modified inputs.</dd>

<dt><a href="exceptions.htm">Exceptions Thrown By Computations</a></dt><dd>Computations that result in <code>#VALUE!</code>, <code>#DIV/0!</code> or some such in Excel throw exceptions in <span class="caps">AFC</span>.</dd>
</dl>

	<h2>Repeating Sections</h2>

	<p>Define <em>repeating sections</em> which are like ranges in Excel, but their width or height may vary with each use of the computation.</p>


<dl>
<dt><a href="repeatingsections.htm">Variable-length Data Series</a></dt><dd>Sometimes you need to pass a data series of variable length to a computation. For example, the dates and totals of all orders in the last 3 months. This is what <span class="caps">AFC</span>&#8217;s <em>repeating sections</em> are for.</dd>

<dt><a href="repeatingsections_withoutputs.htm">Variable Number of Computations</a></dt><dd>To go one step further, sometimes you need <span class="caps">AFC</span> to compute distinct output values for each of the elements of a variable-length data series. For example, the bonus amount for each employee, given the total bonus for the company. Doing the loop over the series yourself can be severely limiting the range of computations your users can formulate because they cannot aggregate over the whole series. <span class="caps">AFC</span> therefore supports per-element outputs in repeating sections.</dd>
</dl>

	<h2>Binding in Detail</h2>

	<p>Advanced use cases concerning the binding of the input and output cells of a spreadsheet to the methods of your Java interfaces or classes.</p>


<dl>
<dt><a href="bindcells.htm">Binding Cells</a></dt><dd>How to explicitly bind specific input and output cells of a spreadsheet to methods of plain Java interfaces or classes.</dd>

<dt><a href="bindparams.htm">Binding To Parametrized Methods</a></dt><dd>If you have a generic system where the set of possible input and/or output values cannot be determined at compile-time, you have to resort to some sort of binding to parametrized methods.</dd>

<dt><a href="bindmultipleinterfaces.htm">Binding To Multiple Interfaces</a></dt><dd><span class="caps">AFC</span> only allows you to set a single interface to provide inputs to or obtain outputs from a computation. How can you work around this?</dd>

<dt><a href="bindmultipleinstances.htm">Binding To Multiple Instances</a></dt><dd>What if you need to provide multiple separate instances of source interfaces as input providers, or need <span class="caps">AFC</span> to implement multiple separate instances of output interfaces?</dd>
</dl>

	<h2>Miscellany</h2>

<dl>
<dt><a href="decompile.htm">Decompiling An Engine</a></dt><dd>If you want to know what kind of code <span class="caps">AFC</span> generates, looking at the resulting <span class="caps">JVM</span> byte code is not everyone&#8217;s thing. To simplify this, you can ask <span class="caps">AFC</span> to decompile the generated byte code to Java source code (this feature uses the <a href="http://jode.sourceforge.net/">JODE</a> library).</dd>

<dt><a href="buildsheet.htm">Using <span class="caps">AFC</span> Without A Spreadsheet File</a></dt><dd>Some applications may wish to use <span class="caps">AFC</span> to compile computation engines, but want users to be able to specify simple computations without having to setup a spreadsheet file. These can use a builder to dynamically construct a spreadsheet model as input to <span class="caps">AFC</span>.</dd>

<dt><a href="generatesheet.htm">Generating An Initial Spreadsheet File</a></dt><dd>Allows you to generate initial spreadsheet files that, for instance, already define cells for the most typically used inputs and outputs. Or, when you are <a href="buildsheet.htm">using <span class="caps">AFC</span> without a spreadsheet file</a>, you can let users switch to using one transparently by generating a file for their existing formula definition.</dd>

<dt><a href="customclassloader.htm">Using A Custom ClassLoader</a></dt><dd>Some companies use a custom <code>ClassLoader</code> to, for example, speed up class loading. If you don&#8217;t replace Java&#8217;s default class loader (<code>ClassLoader.getSystemClassLoader()</code>), you may have to make sure that the engines generated by <span class="caps">AFC</span> use your custom implementation.</dd>

<dt><a href="errors.htm">Compiler Errors</a></dt><dd>See what happens when something goes wrong, and find hints on what to do.</dd>
</dl>

	<h2>Note On The Sample Code</h2>

	<p>To ensure its correctness, all the sample code in this tutorial has been <a href="http://arrenbrecht.ch/jcite/">cited from automated tests</a> that are run with every release build (unless stated otherwise). The tests and data can be found in in the source distribution of <span class="caps">AFC</span> in</p>

<ul>
	<li><code>components/system/src/test/java</code></li>
	<li><code>components/system/src/test/data</code></li>
</ul>

			</div>
			<div class="chrome" id="inner_bottom_chrome">
			</div>
		</div>
		
		
		
		<div class="chrome" id="left_top_chrome">
			<div id="area_toc"><div class="area"><a href="../../doc/design.htm">Design Overview</a></div>
<div class="area"><span class="selected">Tutorial</span></div>
<div class="nested">
</div>
<div class="area"><a href="../../doc/reference/index.htm">Function Reference</a></div>
<div class="area"><a href="../../doc/javadoc/index.html">API Reference</a></div>
<div class="area"><a href="../../doc/examples/index.htm">Sample Applications</a></div>
<div class="area"><a href="../../doc/impl/index.htm">Implementation Details</a></div>
<div class="area"><a href="../../doc/limitations.htm">Limitations</a></div></div>
		</div>
		</div>
		<div class="chrome" id="left_bottom_chrome">
			<div id="copyright">
				Copyright &copy; 2005-2008 by <a href="http://www.abacus.ch/">Abacus Research AG</a>.  All rights reserved.
			</div>
		</div>
	
</body>
</html>
